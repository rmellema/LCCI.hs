<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
A module that holds classes and functions for transforming a given
datastructure into its (La)TeX representation. This module assumes things
will be printed in mathmode, unless specifically mentioned otherwise or
enabled by the resulting LaTeX code itself. It will also assume the
excistens of the following LaTeX macros:

 [@\\lnot@] Logical negation

 [@\\land@] Logical conjunction

 [@\\lor@] Logical disjunction

 [@\\lior@] Inquisitive disjunction

 [@\\lif@] Material conditional

 [@\\liff@] Biimplication

 [@\\lac@] Typesets the modal program operator. Takes one argument, which is
            the program that goes into the modal operator.

 [@\\liac@] Typesets the inquisitive modal program operator. Takes one
            argument, which is the program that goes into the modal operator.

 [@\\lup@] Typesets the update operator. Takes an optional argument (the name
            of the update model) and a required one (the (set of) events that
            is being executed.

 [@\\upd@] Typesets in the font used for update model symbols. Takes one argument, the thing to be typeset in that font.

 [@\\pre@] Typesets the function for the precondition. Takes one argument, the thing upon which the function is called.

 [@\\sub@] Typesets the function for the substitution. Takes one argument, the thing upon which the function is called.
 -}</span><span>
</span><a name="line-36"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">LCCI.Util.Tex</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">intercalate</span><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><a href="LCCI.Issue.html"><span class="hs-identifier">LCCI.Issue</span></a><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><a href="LCCI.Model.html"><span class="hs-identifier">LCCI.Model</span></a><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><a href="LCCI.Syntax.html"><span class="hs-identifier">LCCI.Syntax</span></a><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><a href="LCCI.Util.html"><span class="hs-identifier">LCCI.Util</span></a><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span class="hs-comment">-- | Convert a datastructure to a valid TeX representation of the structure.</span><span>
</span><a name="line-44"></a><span class="hs-comment">-- May use the commands given at the start of this module.</span><span>
</span><a name="line-45"></a><span class="hs-keyword">class</span><span> </span><a name="Texable"><a href="LCCI.Util.Tex.html#Texable"><span class="hs-identifier">Texable</span></a></a><span> </span><a name="local-6989586621679044551"><a href="#local-6989586621679044551"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-46"></a><span>    </span><span class="hs-comment">-- | Create a TeX representation of the given object, prepended with the</span><span>
</span><a name="line-47"></a><span>    </span><span class="hs-comment">-- given string on each line, put in braces.</span><span>
</span><a name="line-48"></a><span>    </span><a name="texWithParen"><a href="LCCI.Util.Tex.html#texWithParen"><span class="hs-identifier">texWithParen</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679044551"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-49"></a><span>    </span><a name="local-8214565720323819455"><a href="LCCI.Util.Tex.html#texWithParen"><span class="hs-identifier">texWithParen</span></a></a><span> </span><a name="local-6989586621679044552"><a href="#local-6989586621679044552"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679044553"><a href="#local-6989586621679044553"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679044552"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="LCCI.Util.Tex.html#toTexWithParen"><span class="hs-identifier hs-var">toTexWithParen</span></a><span> </span><a href="#local-6989586621679044553"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-50"></a><span>    </span><span class="hs-comment">-- | Create a TeX representation of the given object, prepend with the</span><span>
</span><a name="line-51"></a><span>    </span><span class="hs-comment">-- given string on each line</span><span>
</span><a name="line-52"></a><span>    </span><a name="texPrepend"><a href="LCCI.Util.Tex.html#texPrepend"><span class="hs-identifier">texPrepend</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679044551"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-53"></a><span>    </span><a name="local-8214565720323819456"><a href="LCCI.Util.Tex.html#texPrepend"><span class="hs-identifier">texPrepend</span></a></a><span> </span><a name="local-6989586621679044554"><a href="#local-6989586621679044554"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679044555"><a href="#local-6989586621679044555"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679044554"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="LCCI.Util.Tex.html#toTex"><span class="hs-identifier hs-var">toTex</span></a><span> </span><a href="#local-6989586621679044555"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-54"></a><span>    </span><span class="hs-comment">-- | Create a TeX representation of the given subject, if needed within</span><span>
</span><a name="line-55"></a><span>    </span><span class="hs-comment">-- brackets</span><span>
</span><a name="line-56"></a><span>    </span><a name="toTexWithParen"><a href="LCCI.Util.Tex.html#toTexWithParen"><span class="hs-identifier">toTexWithParen</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679044551"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-57"></a><span>    </span><a name="local-8214565720323819457"><a href="LCCI.Util.Tex.html#toTexWithParen"><span class="hs-identifier">toTexWithParen</span></a></a><span> </span><a name="local-6989586621679044556"><a href="#local-6989586621679044556"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">'('</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="LCCI.Util.Tex.html#toTex"><span class="hs-identifier hs-var">toTex</span></a><span> </span><a href="#local-6989586621679044556"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-58"></a><span>    </span><span class="hs-comment">-- | Create a TeX representation of a given object</span><span>
</span><a name="line-59"></a><span>    </span><a name="toTex"><a href="LCCI.Util.Tex.html#toTex"><span class="hs-identifier">toTex</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679044551"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-60"></a><span>    </span><a name="local-8214565720323819458"><a href="LCCI.Util.Tex.html#toTex"><span class="hs-identifier">toTex</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.Tex.html#texPrepend"><span class="hs-identifier hs-var">texPrepend</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-comment">-- | Enclose the TeX representation of the list with the first and second</span><span>
</span><a name="line-63"></a><span class="hs-comment">-- argument, separated by the third. Useful for making lists and sets.</span><span>
</span><a name="line-64"></a><span class="hs-identifier">enclose</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="LCCI.Util.Tex.html#Texable"><span class="hs-identifier hs-type">Texable</span></a><span> </span><a href="#local-6989586621679044599"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679044599"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-65"></a><a name="enclose"><a href="LCCI.Util.Tex.html#enclose"><span class="hs-identifier">enclose</span></a></a><span> </span><a name="local-6989586621679044600"><a href="#local-6989586621679044600"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679044601"><a href="#local-6989586621679044601"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679044602"><a href="#local-6989586621679044602"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679044603"><a href="#local-6989586621679044603"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679044600"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">intercalate</span><span> </span><a href="#local-6989586621679044602"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="LCCI.Util.Tex.html#toTexWithParen"><span class="hs-identifier hs-var">toTexWithParen</span></a><span> </span><a href="#local-6989586621679044603"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679044601"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-comment">-- | Get the TeX representation enclosed in parenthesis. The first argument is</span><span>
</span><a name="line-68"></a><span class="hs-comment">-- the separator for in between the elements.</span><span>
</span><a name="line-69"></a><span class="hs-identifier">withParens</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="LCCI.Util.Tex.html#Texable"><span class="hs-identifier hs-type">Texable</span></a><span> </span><a href="#local-6989586621679044598"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679044598"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-70"></a><a name="withParens"><a href="LCCI.Util.Tex.html#withParens"><span class="hs-identifier">withParens</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.Tex.html#enclose"><span class="hs-identifier hs-var">enclose</span></a><span> </span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-identifier">asSet</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="LCCI.Util.Tex.html#Texable"><span class="hs-identifier hs-type">Texable</span></a><span> </span><a href="#local-6989586621679044597"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679044597"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-73"></a><a name="asSet"><a href="LCCI.Util.Tex.html#asSet"><span class="hs-identifier">asSet</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.Tex.html#enclose"><span class="hs-identifier hs-var">enclose</span></a><span> </span><span class="hs-string">&quot;\\{&quot;</span><span> </span><span class="hs-string">&quot;\\}&quot;</span><span> </span><span class="hs-string">&quot;, &quot;</span><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span class="hs-keyword">instance</span><span> </span><a href="LCCI.Util.Tex.html#Texable"><span class="hs-identifier hs-type">Texable</span></a><span> </span><a href="LCCI.Syntax.html#Program"><span class="hs-identifier hs-type">Program</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-76"></a><span>    </span><a name="local-8214565720323819457"><a href="LCCI.Util.Tex.html#toTexWithParen"><span class="hs-identifier">toTexWithParen</span></a></a><span> </span><span class="hs-special">(</span><a href="LCCI.Syntax.html#Atom"><span class="hs-identifier hs-var">Atom</span></a><span> </span><a name="local-6989586621679044588"><a href="#local-6989586621679044588"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a><span> </span><a href="#local-6989586621679044588"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-77"></a><span>    </span><span class="hs-identifier">toTexWithParen</span><span> </span><span class="hs-special">(</span><a href="LCCI.Syntax.html#Test"><span class="hs-identifier hs-var">Test</span></a><span> </span><a name="local-6989586621679044589"><a href="#local-6989586621679044589"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">'?'</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="LCCI.Util.Tex.html#toTexWithParen"><span class="hs-identifier hs-var">toTexWithParen</span></a><span> </span><a href="#local-6989586621679044589"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-78"></a><span>    </span><span class="hs-identifier">toTexWithParen</span><span> </span><a name="local-6989586621679044590"><a href="#local-6989586621679044590"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="LCCI.Syntax.html#Iterate"><span class="hs-identifier hs-var">Iterate</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.Tex.html#toTex"><span class="hs-identifier hs-var">toTex</span></a><span> </span><a href="#local-6989586621679044590"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-79"></a><span>    </span><span class="hs-identifier">toTexWithParen</span><span> </span><a name="local-6989586621679044591"><a href="#local-6989586621679044591"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">'('</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="LCCI.Util.Tex.html#toTex"><span class="hs-identifier hs-var">toTex</span></a><span> </span><a href="#local-6989586621679044591"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span>    </span><a name="local-8214565720323819458"><a href="LCCI.Util.Tex.html#toTex"><span class="hs-identifier">toTex</span></a></a><span> </span><span class="hs-special">(</span><a href="LCCI.Syntax.html#Atom"><span class="hs-identifier hs-var">Atom</span></a><span> </span><a name="local-6989586621679044592"><a href="#local-6989586621679044592"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a><span> </span><a href="#local-6989586621679044592"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-82"></a><span>    </span><span class="hs-identifier">toTex</span><span> </span><span class="hs-special">(</span><a href="LCCI.Syntax.html#Test"><span class="hs-identifier hs-var">Test</span></a><span> </span><a name="local-6989586621679044593"><a href="#local-6989586621679044593"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">'?'</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="LCCI.Util.Tex.html#toTexWithParen"><span class="hs-identifier hs-var">toTexWithParen</span></a><span> </span><a href="#local-6989586621679044593"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-83"></a><span>    </span><span class="hs-identifier">toTex</span><span> </span><span class="hs-special">(</span><a href="LCCI.Syntax.html#Sequence"><span class="hs-identifier hs-var">Sequence</span></a><span> </span><a name="local-6989586621679044594"><a href="#local-6989586621679044594"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">intercalate</span><span> </span><span class="hs-string">&quot; ; &quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="LCCI.Util.Tex.html#toTexWithParen"><span class="hs-identifier hs-var">toTexWithParen</span></a><span> </span><a href="#local-6989586621679044594"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-84"></a><span>    </span><span class="hs-identifier">toTex</span><span> </span><span class="hs-special">(</span><a href="LCCI.Syntax.html#Choice"><span class="hs-identifier hs-var">Choice</span></a><span> </span><a name="local-6989586621679044595"><a href="#local-6989586621679044595"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">intercalate</span><span> </span><span class="hs-string">&quot; \\cup &quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="LCCI.Util.Tex.html#toTexWithParen"><span class="hs-identifier hs-var">toTexWithParen</span></a><span> </span><a href="#local-6989586621679044595"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-85"></a><span>    </span><span class="hs-identifier">toTex</span><span> </span><span class="hs-special">(</span><a href="LCCI.Syntax.html#Iterate"><span class="hs-identifier hs-var">Iterate</span></a><span> </span><a name="local-6989586621679044596"><a href="#local-6989586621679044596"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">'{'</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="LCCI.Util.Tex.html#toTexWithParen"><span class="hs-identifier hs-var">toTexWithParen</span></a><span> </span><a href="#local-6989586621679044596"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;}^*&quot;</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span class="hs-keyword">instance</span><span> </span><a href="LCCI.Util.Tex.html#Texable"><span class="hs-identifier hs-type">Texable</span></a><span> </span><a href="LCCI.Syntax.html#Formula"><span class="hs-identifier hs-type">Formula</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-88"></a><span>    </span><a name="local-8214565720323819457"><a href="LCCI.Util.Tex.html#toTexWithParen"><span class="hs-identifier">toTexWithParen</span></a></a><span> </span><a name="local-6989586621679044558"><a href="#local-6989586621679044558"><span class="hs-identifier">f</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="LCCI.Syntax.html#Prop"><span class="hs-identifier hs-var">Prop</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.Tex.html#toTex"><span class="hs-identifier hs-var">toTex</span></a><span> </span><a href="#local-6989586621679044558"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-89"></a><span>    </span><span class="hs-identifier">toTexWithParen</span><span> </span><a href="LCCI.Syntax.html#Bot"><span class="hs-identifier hs-var">Bot</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.Tex.html#toTex"><span class="hs-identifier hs-var">toTex</span></a><span> </span><a href="LCCI.Syntax.html#Bot"><span class="hs-identifier hs-var">Bot</span></a><span>
</span><a name="line-90"></a><span>    </span><span class="hs-identifier">toTexWithParen</span><span> </span><a href="LCCI.Syntax.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.Tex.html#toTex"><span class="hs-identifier hs-var">toTex</span></a><span> </span><a href="LCCI.Syntax.html#Top"><span class="hs-identifier hs-var">Top</span></a><span>
</span><a name="line-91"></a><span>    </span><span class="hs-identifier">toTexWithParen</span><span> </span><a name="local-6989586621679044559"><a href="#local-6989586621679044559"><span class="hs-identifier">f</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="LCCI.Syntax.html#Neg"><span class="hs-identifier hs-var">Neg</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.Tex.html#toTex"><span class="hs-identifier hs-var">toTex</span></a><span> </span><a href="#local-6989586621679044559"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-92"></a><span>    </span><span class="hs-identifier">toTexWithParen</span><span> </span><a name="local-6989586621679044560"><a href="#local-6989586621679044560"><span class="hs-identifier">f</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="LCCI.Syntax.html#Quest"><span class="hs-identifier hs-var">Quest</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.Tex.html#toTex"><span class="hs-identifier hs-var">toTex</span></a><span> </span><a href="#local-6989586621679044560"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-93"></a><span>    </span><span class="hs-identifier">toTexWithParen</span><span> </span><span class="hs-special">(</span><a href="LCCI.Syntax.html#And"><span class="hs-identifier hs-var">And</span></a><span> </span><a name="local-6989586621679044561"><a href="#local-6989586621679044561"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.Tex.html#withParens"><span class="hs-identifier hs-var">withParens</span></a><span> </span><span class="hs-string">&quot; \\land &quot;</span><span> </span><a href="#local-6989586621679044561"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-94"></a><span>    </span><span class="hs-identifier">toTexWithParen</span><span> </span><span class="hs-special">(</span><a href="LCCI.Syntax.html#Or"><span class="hs-identifier hs-var">Or</span></a><span> </span><a name="local-6989586621679044562"><a href="#local-6989586621679044562"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.Tex.html#withParens"><span class="hs-identifier hs-var">withParens</span></a><span> </span><span class="hs-string">&quot; \\lor &quot;</span><span> </span><a href="#local-6989586621679044562"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-95"></a><span>    </span><span class="hs-identifier">toTexWithParen</span><span> </span><span class="hs-special">(</span><a href="LCCI.Syntax.html#IOr"><span class="hs-identifier hs-var">IOr</span></a><span> </span><a name="local-6989586621679044563"><a href="#local-6989586621679044563"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.Tex.html#withParens"><span class="hs-identifier hs-var">withParens</span></a><span> </span><span class="hs-string">&quot; \\lior &quot;</span><span> </span><a href="#local-6989586621679044563"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-96"></a><span>    </span><span class="hs-identifier">toTexWithParen</span><span> </span><span class="hs-special">(</span><a href="LCCI.Syntax.html#Cond"><span class="hs-identifier hs-var">Cond</span></a><span> </span><a name="local-6989586621679044564"><a href="#local-6989586621679044564"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679044565"><a href="#local-6989586621679044565"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.Tex.html#withParens"><span class="hs-identifier hs-var">withParens</span></a><span> </span><span class="hs-string">&quot; \\lif &quot;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679044564"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679044565"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">]</span><span>
</span><a name="line-97"></a><span>    </span><span class="hs-identifier">toTexWithParen</span><span> </span><span class="hs-special">(</span><a href="LCCI.Syntax.html#BiCond"><span class="hs-identifier hs-var">BiCond</span></a><span> </span><a name="local-6989586621679044566"><a href="#local-6989586621679044566"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679044567"><a href="#local-6989586621679044567"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.Tex.html#withParens"><span class="hs-identifier hs-var">withParens</span></a><span> </span><span class="hs-string">&quot; \\liff &quot;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679044566"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679044567"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">]</span><span>
</span><a name="line-98"></a><span>    </span><span class="hs-identifier">toTexWithParen</span><span> </span><a name="local-6989586621679044568"><a href="#local-6989586621679044568"><span class="hs-identifier">f</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="LCCI.Syntax.html#Modal"><span class="hs-identifier hs-var">Modal</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.Tex.html#toTex"><span class="hs-identifier hs-var">toTex</span></a><span> </span><a href="#local-6989586621679044568"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-99"></a><span>    </span><span class="hs-identifier">toTexWithParen</span><span> </span><a name="local-6989586621679044569"><a href="#local-6989586621679044569"><span class="hs-identifier">f</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="LCCI.Syntax.html#IModal"><span class="hs-identifier hs-var">IModal</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.Tex.html#toTex"><span class="hs-identifier hs-var">toTex</span></a><span> </span><a href="#local-6989586621679044569"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-100"></a><span>    </span><span class="hs-identifier">toTexWithParen</span><span> </span><a name="local-6989586621679044570"><a href="#local-6989586621679044570"><span class="hs-identifier">f</span></a></a><span class="hs-glyph">@</span><a href="LCCI.Syntax.html#Update"><span class="hs-identifier hs-var">Update</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.Tex.html#toTex"><span class="hs-identifier hs-var">toTex</span></a><span> </span><a href="#local-6989586621679044570"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span>    </span><a name="local-8214565720323819458"><a href="LCCI.Util.Tex.html#toTex"><span class="hs-identifier">toTex</span></a></a><span> </span><span class="hs-special">(</span><a href="LCCI.Syntax.html#Prop"><span class="hs-identifier hs-var">Prop</span></a><span> </span><a name="local-6989586621679044571"><a href="#local-6989586621679044571"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a><span> </span><a href="#local-6989586621679044571"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-103"></a><span>    </span><span class="hs-identifier">toTex</span><span> </span><a href="LCCI.Syntax.html#Bot"><span class="hs-identifier hs-var">Bot</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;\\bot&quot;</span><span>
</span><a name="line-104"></a><span>    </span><span class="hs-identifier">toTex</span><span> </span><a href="LCCI.Syntax.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;\\top&quot;</span><span>
</span><a name="line-105"></a><span>    </span><span class="hs-identifier">toTex</span><span> </span><span class="hs-special">(</span><a href="LCCI.Syntax.html#Neg"><span class="hs-identifier hs-var">Neg</span></a><span> </span><a name="local-6989586621679044572"><a href="#local-6989586621679044572"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.Tex.html#texWithParen"><span class="hs-identifier hs-var">texWithParen</span></a><span> </span><span class="hs-string">&quot;\\lnot&quot;</span><span> </span><a href="#local-6989586621679044572"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-106"></a><span>    </span><span class="hs-identifier">toTex</span><span> </span><span class="hs-special">(</span><a href="LCCI.Syntax.html#Quest"><span class="hs-identifier hs-var">Quest</span></a><span> </span><a name="local-6989586621679044573"><a href="#local-6989586621679044573"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.Tex.html#texWithParen"><span class="hs-identifier hs-var">texWithParen</span></a><span> </span><span class="hs-string">&quot;?&quot;</span><span> </span><a href="#local-6989586621679044573"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-107"></a><span>    </span><span class="hs-identifier">toTex</span><span> </span><span class="hs-special">(</span><a href="LCCI.Syntax.html#And"><span class="hs-identifier hs-var">And</span></a><span> </span><a name="local-6989586621679044574"><a href="#local-6989586621679044574"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">intercalate</span><span> </span><span class="hs-string">&quot; \\land &quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="LCCI.Util.Tex.html#toTexWithParen"><span class="hs-identifier hs-var">toTexWithParen</span></a><span> </span><a href="#local-6989586621679044574"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-108"></a><span>    </span><span class="hs-identifier">toTex</span><span> </span><span class="hs-special">(</span><a href="LCCI.Syntax.html#Or"><span class="hs-identifier hs-var">Or</span></a><span> </span><a name="local-6989586621679044575"><a href="#local-6989586621679044575"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">intercalate</span><span> </span><span class="hs-string">&quot; \\lor &quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="LCCI.Util.Tex.html#toTexWithParen"><span class="hs-identifier hs-var">toTexWithParen</span></a><span> </span><a href="#local-6989586621679044575"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-109"></a><span>    </span><span class="hs-identifier">toTex</span><span> </span><span class="hs-special">(</span><a href="LCCI.Syntax.html#IOr"><span class="hs-identifier hs-var">IOr</span></a><span> </span><a name="local-6989586621679044576"><a href="#local-6989586621679044576"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">intercalate</span><span> </span><span class="hs-string">&quot; \\lior &quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="LCCI.Util.Tex.html#toTexWithParen"><span class="hs-identifier hs-var">toTexWithParen</span></a><span> </span><a href="#local-6989586621679044576"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-110"></a><span>    </span><span class="hs-identifier">toTex</span><span> </span><span class="hs-special">(</span><a href="LCCI.Syntax.html#Cond"><span class="hs-identifier hs-var">Cond</span></a><span> </span><a name="local-6989586621679044577"><a href="#local-6989586621679044577"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679044578"><a href="#local-6989586621679044578"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.Tex.html#toTexWithParen"><span class="hs-identifier hs-var">toTexWithParen</span></a><span> </span><a href="#local-6989586621679044577"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; \\lif &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="LCCI.Util.Tex.html#toTexWithParen"><span class="hs-identifier hs-var">toTexWithParen</span></a><span> </span><a href="#local-6989586621679044578"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-111"></a><span>    </span><span class="hs-identifier">toTex</span><span> </span><span class="hs-special">(</span><a href="LCCI.Syntax.html#BiCond"><span class="hs-identifier hs-var">BiCond</span></a><span> </span><a name="local-6989586621679044579"><a href="#local-6989586621679044579"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679044580"><a href="#local-6989586621679044580"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.Tex.html#toTexWithParen"><span class="hs-identifier hs-var">toTexWithParen</span></a><span> </span><a href="#local-6989586621679044579"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; \\liff &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="LCCI.Util.Tex.html#toTexWithParen"><span class="hs-identifier hs-var">toTexWithParen</span></a><span> </span><a href="#local-6989586621679044580"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-112"></a><span>    </span><span class="hs-identifier">toTex</span><span> </span><span class="hs-special">(</span><a href="LCCI.Syntax.html#Modal"><span class="hs-identifier hs-var">Modal</span></a><span> </span><a name="local-6989586621679044581"><a href="#local-6989586621679044581"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679044582"><a href="#local-6989586621679044582"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.Tex.html#texWithParen"><span class="hs-identifier hs-var">texWithParen</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;\\lac{&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="LCCI.Util.Tex.html#toTexWithParen"><span class="hs-identifier hs-var">toTexWithParen</span></a><span> </span><a href="#local-6989586621679044581"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;}&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679044582"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-113"></a><span>    </span><span class="hs-identifier">toTex</span><span> </span><span class="hs-special">(</span><a href="LCCI.Syntax.html#IModal"><span class="hs-identifier hs-var">IModal</span></a><span> </span><a name="local-6989586621679044583"><a href="#local-6989586621679044583"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679044584"><a href="#local-6989586621679044584"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.Tex.html#texWithParen"><span class="hs-identifier hs-var">texWithParen</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;\\liac{&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="LCCI.Util.Tex.html#toTexWithParen"><span class="hs-identifier hs-var">toTexWithParen</span></a><span> </span><a href="#local-6989586621679044583"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;}&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679044584"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-114"></a><span>    </span><span class="hs-identifier">toTex</span><span> </span><span class="hs-special">(</span><a href="LCCI.Syntax.html#Update"><span class="hs-identifier hs-var">Update</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679044585"><a href="#local-6989586621679044585"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679044586"><a href="#local-6989586621679044586"><span class="hs-identifier">es</span></a></a><span> </span><a name="local-6989586621679044587"><a href="#local-6989586621679044587"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.Tex.html#texWithParen"><span class="hs-identifier hs-var">texWithParen</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;\\lup[&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679044585"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;]{&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="LCCI.Util.Tex.html#asSet"><span class="hs-identifier hs-var">asSet</span></a><span> </span><a href="#local-6989586621679044586"><span class="hs-identifier hs-var">es</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;}&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679044587"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-keyword">instance</span><span> </span><a href="LCCI.Util.Tex.html#Texable"><span class="hs-identifier hs-type">Texable</span></a><span> </span><a href="LCCI.Model.html#Event"><span class="hs-identifier hs-type">Event</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-117"></a><span>    </span><a name="local-8214565720323819457"><a href="LCCI.Util.Tex.html#toTexWithParen"><span class="hs-identifier">toTexWithParen</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="LCCI.Util.Tex.html#toTex"><span class="hs-identifier hs-var">toTex</span></a><span>
</span><a name="line-118"></a><span>    </span><a name="local-8214565720323819458"><a href="LCCI.Util.Tex.html#toTex"><span class="hs-identifier">toTex</span></a></a><span> </span><span class="hs-special">(</span><a href="LCCI.Model.html#Event"><span class="hs-identifier hs-var">Event</span></a><span> </span><a name="local-6989586621679044557"><a href="#local-6989586621679044557"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;\\upd{e_&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679044557"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;}&quot;</span><span>
</span><a name="line-119"></a></pre></body></html>